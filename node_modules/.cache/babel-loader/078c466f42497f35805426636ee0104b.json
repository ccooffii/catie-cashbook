{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Cao/Desktop/cashbook-online-by-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/Cao/Desktop/cashbook-online-by-react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Cao/Desktop/cashbook-online-by-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useRef,useState}from\"react\";export var useRecords=function useRecords(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),records=_useState2[0],setRecords=_useState2[1];var addRecord=function addRecord(tempRecord){if(tempRecord.amount<=0){return;}if(tempRecord.tagIds.length===0){return;}var record=_objectSpread(_objectSpread({},tempRecord),{},{createdAt:new Date().toISOString()});setRecords([].concat(_toConsumableArray(records),[record]));};useEffect(function(){setRecords(JSON.parse(window.localStorage.getItem('records')||'[]'));},[]);var count=useRef(0);useEffect(function(){count.current+=1;});useEffect(function(){if(count.current>1){window.localStorage.setItem('records',JSON.stringify(records));}});return{records:records,addRecord:addRecord};};","map":{"version":3,"names":["useEffect","useRef","useState","useRecords","records","setRecords","addRecord","tempRecord","amount","tagIds","length","record","createdAt","Date","toISOString","JSON","parse","window","localStorage","getItem","count","current","setItem","stringify"],"sources":["C:/Users/Cao/Desktop/cashbook-online-by-react/src/hooks/useRecords.tsx"],"sourcesContent":["import {useEffect, useRef, useState} from \"react\";\r\nexport type RecordItem = {\r\n    tagIds:number[]\r\n    note:string\r\n    category:('+'|'-')\r\n    amount:number\r\n    createdAt: string\r\n}\r\ntype tempRecordItem = {\r\n    tagIds:number[]\r\n    note:string\r\n    category:('+'|'-')\r\n    amount:number\r\n}\r\nexport const useRecords = () => {\r\n    const [records, setRecords] = useState<RecordItem[]>([])\r\n    const addRecord = (tempRecord:tempRecordItem) => {\r\n        if(tempRecord.amount <= 0){return}\r\n        if(tempRecord.tagIds.length === 0){\r\n            return;\r\n        }\r\n        const record = {...tempRecord,createdAt:(new Date().toISOString())}\r\n        setRecords([...records,record])\r\n    };\r\n    useEffect(()=>{\r\n        setRecords(JSON.parse(window.localStorage.getItem('records')||'[]'))\r\n    },[])\r\n    const count = useRef(0);\r\n    useEffect(() => {\r\n        count.current += 1;\r\n    })\r\n    useEffect(()=>{\r\n        if(count.current > 1){\r\n            window.localStorage.setItem('records',JSON.stringify(records))\r\n        }\r\n    })\r\n    return{records,addRecord}\r\n}"],"mappings":"gZAAA,OAAQA,SAAR,CAAmBC,MAAnB,CAA2BC,QAA3B,KAA0C,OAA1C,CAcA,MAAO,IAAMC,WAAU,CAAG,QAAbA,WAAa,EAAM,CAC5B,cAA8BD,QAAQ,CAAe,EAAf,CAAtC,wCAAOE,OAAP,eAAgBC,UAAhB,eACA,GAAMC,UAAS,CAAG,QAAZA,UAAY,CAACC,UAAD,CAA+B,CAC7C,GAAGA,UAAU,CAACC,MAAX,EAAqB,CAAxB,CAA0B,CAAC,OAAO,CAClC,GAAGD,UAAU,CAACE,MAAX,CAAkBC,MAAlB,GAA6B,CAAhC,CAAkC,CAC9B,OACH,CACD,GAAMC,OAAM,gCAAOJ,UAAP,MAAkBK,SAAS,CAAE,GAAIC,KAAJ,GAAWC,WAAX,EAA7B,EAAZ,CACAT,UAAU,8BAAKD,OAAL,GAAaO,MAAb,GAAV,CACH,CAPD,CAQAX,SAAS,CAAC,UAAI,CACVK,UAAU,CAACU,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,SAA5B,GAAwC,IAAnD,CAAD,CAAV,CACH,CAFQ,CAEP,EAFO,CAAT,CAGA,GAAMC,MAAK,CAAGnB,MAAM,CAAC,CAAD,CAApB,CACAD,SAAS,CAAC,UAAM,CACZoB,KAAK,CAACC,OAAN,EAAiB,CAAjB,CACH,CAFQ,CAAT,CAGArB,SAAS,CAAC,UAAI,CACV,GAAGoB,KAAK,CAACC,OAAN,CAAgB,CAAnB,CAAqB,CACjBJ,MAAM,CAACC,YAAP,CAAoBI,OAApB,CAA4B,SAA5B,CAAsCP,IAAI,CAACQ,SAAL,CAAenB,OAAf,CAAtC,EACH,CACJ,CAJQ,CAAT,CAKA,MAAM,CAACA,OAAO,CAAPA,OAAD,CAASE,SAAS,CAATA,SAAT,CAAN,CACH,CAvBM"},"metadata":{},"sourceType":"module"}